# Reap the Harvest on Blockchain: A Survey of Yield Farming Protocols  

Jiahua Xu and Yebo Feng  

Abstract—Yield farming represents an immensely popular asset management activity in decentralized finance (DeFi). It involves supplying, borrowing, or staking crypto assets to earn an income in forms of transaction fees, interest, or participation rewards at different DeFi marketplaces. In this systematic survey, we present yield farming protocols as an aggregationlayer constituent of the wider DeFi ecosystem that interact with primitive-layer protocols such as decentralized exchanges (DEXs) and protocols for loanable funds (PLFs). We examine the yield farming mechanism by first studying the operations encoded in the yield farming smart contracts, and then performing stylized, parameterized simulations on various yield farming strategies. We conduct a thorough literature review on related work, and establish a framework for yield farming protocols that takes into account pool structure, accepted token types, and implemented strategies. Using our framework, we characterize major yield aggregators in the market including Yearn Finance, Beefy, and Badger DAO. Moreover, we discuss anecdotal attacks against yield aggregators and generalize a number of risks associated with yield farming.  

Keywords—Decentralized Finance (DeFi), yield farming, yield aggregator, simulation, blockchain  

# I. INTRODUCTION  

Y IaEssLetD fmaarnmaignegrs otn bolloscakrcehadiene.mAefd ear thaevidneg anbtrsaolribzed crypto assets from users—including both retail and institutional investors, yield farming protocols algorithmically deploy those funds into one or more revenue generating services such as lending and market making. Yield farming protocols have become immensely popular as they seem to create a win-winwin situation: users can earn return on their idle funds through an automated process; yield farming protocols can charge a management fee; other DeFi services can gain more liquidity.  

The concept of yield farming was first popularized in mid 2020 by the leading PLF Compound with the introduction of its governance token COMP [92]. Compound participants get rewarded with newly-minted COMP tokens through both lending and borrowing activities, which lead to offsetting some loan costs for borrowers and increasing the return for lenders. This incentive scheme was quickly adopted by other protocols such as Uniswap [121] and Yearn Finance [70]) to attract liquidity and participation. As such, on top of the inherently designed benefit that users get for providing liquidity in different kinds of pools (e.g. interest in the case of lending protocols, or fees in the case of providing liquidity in automated market maker (AMM) pools), additional governance tokens are rewarded to users to further encourage their participation in the issuing platform during the early stage of adoption. The basic yield farming idea was born: the search for opportunities in the DeFi ecosystem to generate returns on otherwise dormant crypto assets.  

Table I: Top yield aggregators - market share information.   


<html><body><table><tr><td>Yield aggregators</td><td>Governance token</td><td>TVL (m USD)</td><td>MCap (m USD)</td><td>Time established</td><td>Tokenholders</td></tr><tr><td>Yearn Finance</td><td>YF I</td><td>652.07</td><td>354.96</td><td>07/2020</td><td>49,668</td></tr><tr><td>Beefy</td><td>BIFI</td><td>302.95</td><td>39.00</td><td>09/2020</td><td>25,737</td></tr><tr><td>Badger DAO</td><td>BADGER</td><td>107.22</td><td>47.83</td><td>11/2020</td><td>30,757</td></tr><tr><td>Idle Finance</td><td>IDLE</td><td>94.17</td><td>1.38</td><td>11/2020</td><td>3,728</td></tr><tr><td>Yield Yak</td><td>YAK</td><td>72.13</td><td>3.56</td><td>09/2021</td><td>2,208</td></tr><tr><td>Autofarm</td><td>AUTO</td><td>64.99</td><td>26.52</td><td>02/2021</td><td>65,074</td></tr><tr><td>Flamincome</td><td>FLAG</td><td>59.55</td><td></td><td>06/2020</td><td>43</td></tr><tr><td>Rari Capital</td><td>RGT</td><td>47.03</td><td>64.27</td><td>07/2020</td><td>6,438</td></tr><tr><td>Vesper</td><td>VSP</td><td>42.62</td><td>4.35</td><td>02/2021</td><td>8,690</td></tr><tr><td>Spool Protocol</td><td>SPOOL</td><td>39.42</td><td>3.99</td><td>12/2021</td><td>522</td></tr><tr><td>Harvest Finance</td><td>FARM</td><td>32.74</td><td>37.39</td><td>09/2020</td><td>13,867</td></tr><tr><td>ACryptoS</td><td>ACS</td><td>30.09</td><td>2.06</td><td>12/2020</td><td>8.078</td></tr><tr><td>Reaper Farm</td><td>OATH</td><td>18.21</td><td>9.25</td><td>07/2021</td><td>2.993</td></tr><tr><td>Pickle Finance</td><td>PICKLE</td><td>14.20</td><td>1.49</td><td>09/2020</td><td>8,161</td></tr><tr><td>OnX Finance</td><td>ONX</td><td>4.63</td><td>1.41</td><td>03/2021</td><td>2,941</td></tr><tr><td>Waterfall DeFi</td><td>WTF</td><td>4.08</td><td>1.74</td><td>11/2021</td><td>852</td></tr><tr><td>Solidex</td><td>SEX</td><td>3.86</td><td>0.19</td><td>02/2022</td><td>9.389</td></tr><tr><td>Robo-Vault</td><td></td><td>3.81</td><td></td><td>07/2021</td><td></td></tr><tr><td>Magik Farm</td><td>MAGIK</td><td>3.57</td><td></td><td>01/2022</td><td>2,110</td></tr></table></body></html>

Data fetched on 14/08/2022 from https://defillama.com/ - Yield Aggregators.  

As a reaction to the creation of a multitude of platforms returning interests, fees and token rewards, yield aggregators— represented by Yearn Finance, Beefy, and Badger DAO (Table I)—dedicated to farming yield through DeFi primitives emerged. At the beginning 2021, the total value locked (TVL) of DeFi yield aggregators was still shy of 1 billion USD; by May 2021, however, this value grew exponentially to 8 billion USD (illustrated in Figure 1).  

In this paper, we present a systemic examination of yield farming protocols. We first inspect yield farming protocols from the perspective of DeFi architecture and posit them as an aggregation-level component that interact with lowerlevel primitives in DeFi (see $\ S \mathbf { I I } )$ . We then synthesize an action-state framework of yield farming operations, and extract yield farming protocols’ features such as pool structure and accepted token types as well as their variations (see $\ S \mathrm { I I I }$ ). With our established model framework, we characterize top yield farming protocols such as Yearn Finance, Harvest Finance and Pickle Finance. We argue that yield farming protocols are still associated with both security and economic risks (see $\ S _ { \mathrm { I V } } )$ and provide a through literature review for interested readers (see $\ S \mathbf { V } _ { \mathbf { \Sigma } }$ ). In Appendix, we present simulations on three typical yield farming strategies in $\ S \mathrm { A }$ , and describe the workings of top yield aggregators comparatively in $\ S \mathbf { B }$ . Of a particular note here is that this paper is an updated and extended version of work published in [69].  

![](images/a3e30ac839ea00875ad57192e8cada1c735fc38762aaecacf32591ca32a640c6.jpg)  
Figure 1: Total value locked (TVL) (b USD) of yield aggregators on Ethereum, BNB Chain and Polygon. Data collected on 12 September 2022 from https://defillama.com/.  

# II. BACKGROUND IN DEFI  

Yield farming protocols are a constituent part of the wider DeFi ecosystem, and operate heavily dependent on other ecosystem components. In this section, we present those related components to understand where yield farming protocols reside within the DeFi ecosystem (illustrated in Figure 2).  

# A. DeFi overview  

Built on top of decentralized blockchain networks, DeFi [128] systems allow various financial products and services, including lending and asset trading, to be available to the general public. Compared with traditional financial systems, DeFi democratizes finance by replacing legacy, centralized institutions with algorithm-backed protocols, thereby improving the accessibility, inclusion, and transparency of financial services [120], [99].  

# B. Chain layer  

The distributed ledger technology (DLT) layer forms the infrastructural basis for decentralized applications (dApps). Like all other dApps, DeFi protocols consist of one or more smart contracts deployed on blockchain. To this end, the DeFi chain layer typically requires compatibility with smart contracts. As the oldest and the most widely adopted DLT that supports smart contracts, the Ethereum blockchain is also home to the majority of DeFi protocols [74]. The blockchain implements Ethereum Virtual Machine (EVM) to ensure that state transitions follow the same rules regardless of node they are performed on. The energy consumption and scalability issues associated with blockchains (e.g., EthereumPoW) that are based on the legacy proof of work (PoW) [104] prompted the emergence of the new Ethereum 2.0 and other EVMcompatible chain layer solutions such as Polygon [106], BNB Chain [65], Fantom [78], and Avalanche [60]. Those solutions incorporate alternative consensus mechanisms like proof of stake (PoS) and exhibit an improved throughput capacity [101]. PoS chains in particular not only provides the architectural foundation for the DeFi ecosystem, but can also be a source of yield: to encourage users’ participation in the consensus of the distributed network, many of these PoS chains—including Ethereum 2.0 [77], Solana [116] and Polkadot [105]—reward users’ staking activities.  

# C. DeFi primitive layer  

Serving as the fundamental building blocks of the application layer of the DeFi ecosystem, DeFi primitives include AMM-based DEXs, PLFs and stablecoins. DeFi yield mainly comes from AMM-based DEXs and PLFs.  

1) AMM-based DEXs: Different from order book-based exchanges where a trade has both buy and sell sides, AMM-based exchanges—often simply referred to as AMM—leverage an algorithm termed “conservation function” to determine the swap rate between two assets given the swap tokens and size [130]. As illustrated in Figure 3a, traders using an AMMbased DEX swap their tokens against the exchange protocol’s liquidity pool, which contains tokens deposited by liquidity providers (LPs). Against their funds contributed, LPs receive “LP tokens” as a form of “I owe you” (IOU), which allow liquidity withdrawal and entitle LPs for their share of swap fee income. At the time of writing this paper, most prominent AMM-based DEXs include Uniswap [122], Curve [71] and Balancer [61].  

2) PLFs: A PLF (illustrated in Figure 3b) typically applies a pre-coded interest rate model that dynamically adjusts the borrow and supply rates [100]. Both rates are commonly programmed to positively correlate with the utilization ratio of the funds, defined as the total amount borrowed as a fraction of the total amount supplied for each specific token asset. PLFs on blockchain are mostly collateral-based rather than credit based. This means that a borrow position can only be created when a sufficient amount of deposit is in place acting as collateral. The collateral might become liquidated if market movements or interest accrual cause the borrow position to become insufficiently collateralized. From the accounting perspective, interest accrual is achieved through “interest-bearing tokens” which, while sitting in their holder’s wallet, increase in value with the passage of time. Analogous to AMM’s LP tokens, interest-bearing tokens also serve as a from of IOU, which are emitted to lenders according to funds supplied and must be surrendered upon funds withdrawal. Aave [55] and Compound [67] can be counted as the two most popular PLFs at the time of writing this paper.  

3) Stablecoins: Stablecoins are token contracts deployed on blockchain representing cryptocurrencies that offer price stability relative to a certain reference asset [98], namely, a “peg”. The peg can be another cryptocurrency, legal tender, commodities, or a combination of the above. At the time of writing this paper, the biggest stablecoins, USDT, USDC and DAI are all pegged to the US Dollar. Stablecoins can be custodial or non-custodial, asset-backed or algorithmically programmed.  

# D. Aggregation layer  

DeFi protocols on the aggregation layer interact with the chain layer or the DeFi primitive layer on end users’ behalf [115]. Depending on whether their target users are requesting or providing services, aggregation layer protocols can be classified as demand-side aggregators and supply-side aggregators. The latter is the category the yield farming protocols belong to.  

![](images/3e0c0d0e5ec3a1a140f6d7665c4d95a4acd218f064d157fb2c9bf6b30b6590c7.jpg)  
Figure 2: Architecture of the DeFi ecosystem on blockchain.  

1) Demand-side aggregators: Channeling similar services offered by DeFi primitives, demand-side aggregators seek to present users with the most competitive offer so that they do not have to manually perform the comparison themselves. DEX aggregators Paraswap [37] and 1inch [1] algorithmically search for the optimal swap route through multiple primitive DEXs to generate the best exchange rate for users.  

2) Supply-side aggregators: All supply-side aggregators to a certain extent perform some form of yield farming. Some protocols farm yields directly from the chain layer. For instance, staking platforms like Lido [93] and Ankr [57] act as a one-stop shop for users to benefit from staking rewards from various PoS chains; yield aggregators like Yearn Finance [134], Beefy [12] and Badger DAO [10] collect users’ funds, redeposit them to DeFi primitives such as DEXs and PLFs or other aggregators to generate returns that will be re-distributed back to the users (presented in Figure 3c).  

# III. YIELD FARMING PRELIMINARIES  

In this section, we dive deep into the workings of yield farming protocols, understand how they generate yield for the users as well as revenue for the protocols themselves.  

# A. Types of yield farming protocols  

There is no universal definition for yield farming protocols. Some equate yield farming protocols to generic yieldgenerating protocols, in which sense, DeFi primitives such as AMMs and PLFs would also be counted as they offer yield to LPs and lenders, respectively. More commonly, however, yield farming protocols refer to protocols on the aggregation layer (see $\ S _ { \mathrm { I I - D ) } }$ that pool funds to generate return by interacting with DeFi primitives. This is the type of yield farming protocols that we focus on in this paper.  

![](images/a2d92996aa606d83bfa8c2238890f102b3db8e331ebcab16874976d36a7967f0.jpg)  

![](images/e57c8cef7580b38c490ff0b75eb5e0d6f18927e80379529baa9ad7436223c8b6.jpg)  

Figure 3: State diagram with describing the interaction between the environment of a DeFi protocol and associated actions. $+$ means positive effect, negative effect.  

Besides yield aggregators which are the most widely recognized type of yield farming protocols, some other protocols are more implicit in their farming activities by branding themselves as e.g. stablecoin or lottery protocols. Those protocols mainly differ in the form of IOU tokens they mint to end users upon new deposit.  

1) Yield aggregators: Represented by Yearn, Beefy and Badger, the most classic and commonly known yield farming protocols are yield aggregators. In return for deposit into a yield farming pool, pool tokens that represent a fraction of the pool wealth are issued. Typically, the value of a pool token varies according to the total pool wealth (see ${ \ S I I I } { \bf { \mathrm { - } } } { \bf { \mathrm { } B } } 2 { \bf { h } } ,$ ).  

2) Yield-bearing stablecoins: A yield-bearing stablecoin protocol works similar to a savings account with a bank. Instead of minting pool tokens, the protocol issues stablecoins to users as a form of certificate of deposit. The yield-generating nature of the protocol is reflected in the increase in the quantity of the stablecoins to their holders, as opposed to the value of the stablecoin token; the value is designed to remain stable to the peg. OUSD issuer Origin Dollar and USDi issuer Bank of Chain [62] are two examples of this type of protocols.  

3) Lottery protocols: A lottery protocol collect users’ funds and issue them each a lottery ticket token in return. The protocol then performs yield farming under the hood. Instead of distributing yield proportionate to users’ deposit, the protocol every once in a while randomly selects one or more winners who can pocket the yield of all participants. PoolTogether [107] is one of the most popular protocols of this type while writing this paper.  

4) NFT farming: Recently, with the popularity of nonfungible tokens (NFTs), groups began to explore involving NFTs in yield farming. The main goal of NFT farming is to create liquidity and utility for NFTs, especially in gaming space, thereby earning yields for token owners [64]. Axie Infinity [52], ZooKeeper [136], Pulsar Farm [54], and MOBOX [53] are typical platforms that provide NFT farming services.  

# B. Yield farming operations  

As illustrated in Figure 3c, the entire yield farming process comprises actions from both the user and the protocol sides. We discuss common action types associated with yield farming protocols. The exact name and implementation of actions may deviate from one protocol to another.  

1) User actions: The actions that yield farming users, a.k.a “farmers”, need to take are often trivial and straightforward.  

a) Deposit: Protocol users simply select their favored yield farming pool and deposit their funds by transferring token assets to the pool smart contract. In return, users receive pool tokens as a form of IOU which should increase in value with the passage of time due to the yield farmed by the protocol [130], [100].  

b) Redeem: Unless there is a timelock, users can redeem their deposited funds plus any yield generated anytime by surrendering their pool tokens.  

2) Protocol actions: The more sophisticated operations are assumed by the algorithm of the protocol where the actual yield farming is performed automatically under the hood.  

a) Mint: The protocol mints pool tokens to the user proportionate to the amount of funds deposited, representing their share of the liquidity within the yield farming pool.  

b) Burn: When a user requests to withdraw funds from a yield farming protocol, pool tokens need to be surrendered by the user and consequently burned by the protocol.  

c) Invest: Depending on the DeFi primitive that the yield farming pool interacts with, the yield farming protocol can invest funds collected from users either into an AMM as a liquidity provider to collect swap fees (see $\ S _ { \mathrm { A 2 c } ) }$ ), or into a PLF as a lender to earn supply interests (see $\ S \mathrm { A } 2 \mathrm { a } )$ ). A yield farming pool may also invest in another yield farming protocol, often for the benefit of receiving reward tokens.  

d) Withdraw: When end users request to redeem their funds from a yield farming pool, the pool contract needs to withdraw the corresponding amount of liquidity from the protocol(s) that it has invested in.  

e) Swap: “Raw yield” does not always come in the form of the originally deposited assets. Therefore, the yield farming protocol may perform a swap, usually on an AMM, to convert yield tokens into the same tokens as originally deposited, which are sometimes reinvested to achieve the compounding effect.  

$f )$ Borrow: Yield farming protocols may use all or part of the funds deposited by users as collateral to borrow from a PLF. This may need to be performed due to various reasons: (i) to arbitrarily inflate the borrow position to be qualified for more participation reward (see $\ S _ { \mathrm { A 2 b } }$ ), (ii) to borrow out assets that can be invested to generate higher yield than the deposited assets.  

g) Repay: Yield farming protocols that take the “borrow” action may need to partially or fully repay their loans to reduce or close its borrow position if: (i) the borrow position is on the verge of becoming liquidated, (ii) the collateral must be withdrawn so that it can be invested elsewhere or returned to end users.  

h) Rebase: A yield farming pool mints or burns pool tokens depends on the quantity of the asset deposited or withdrawn as well as the exchange rate between the pool token and the asset. As yield farming progresses, the farming pool usually accumulates wealth and the exchange rate changes. Due to diversified investment in various protocols, some yield farming pools may possess an array of assets different from the one deposited by end users. Yield farming protocols connect to price oracles to fetch the price of each of these assets, and subsequently calculate the total value held by the pool. The exchange rate can thus be updated through dividing the latest pool value denominated by the asset deposited by end users with the circulating quantity of the pool tokens. This process of updating the pool token price is termed “rebase”.  

# C. Forms of yield farming pools  

Different yield farming protocols vary in terms of their pool structure and token types acceptable by each pool (Table II).  

1) Pool structure: A yield farming pool may accept deposits in single or multiple assets.  

a) Single asset: Most yield farming protocols have single-asset pools. While those pools only accept one particular token asset, they may still hold various assets due to different sorts of yield farmed. Typically, those other assets are automatically swapped for the one acceptable as deposits, and reinvested to generate compounded yield (see ${ \ \ S } _ { } ^ { \mathrm { { I I I - B 2 } } } ,$ ).  

b) Multiple assets: A yield farming pool may also accept multiple token assets. Usually assets acceptable by the same pool share a peg. For example, at the time of writing this paper, Badger DAO’s ibBTC/crvsBTC pool accept ibBTC, renBTC, WBTC and ibbtc/sbtcCRV-f, all pegged to BTC.  

2) Accepted token types: Yield farming protocols accept various types of tokens, ranging from stablecoins to LP tokens.  

Table II: Top yield aggregators - protocol mechanism.   


<html><body><table><tr><td rowspan="2">Yield aggregators</td><td colspan="2">Pool structure</td><td colspan="2">Accepted token type</td><td colspan="2"></td><td colspan="2">Strategies</td><td></td></tr><tr><td></td><td>Single asset Multiple assets Stablecoins LP token Others Simple lending Leveraged borrow Liquidity provision Chains</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Yearn Finance</td><td>[49]</td><td>：</td><td></td><td></td><td></td><td></td><td></td><td></td><td>Ethereum,Fantom</td></tr><tr><td>Beefy</td><td>[12]</td><td>：</td><td></td><td>：</td><td></td><td></td><td></td><td></td><td>Polygon,Fantom,BNB</td></tr><tr><td>Badger DAO</td><td>[10]</td><td>：</td><td>：</td><td></td><td>：</td><td></td><td></td><td>：</td><td>Ethereum,Fantom,Polygon,BNB</td></tr><tr><td>Idle Finance</td><td>[31]</td><td>：</td><td>0</td><td>：</td><td>：</td><td></td><td></td><td></td><td>Ethereum, Polygon</td></tr><tr><td>Yield Yak</td><td>[50]</td><td>：</td><td>0</td><td>：</td><td>：</td><td></td><td></td><td></td><td>Avalanche</td></tr><tr><td>Autofarm</td><td>[9]</td><td>：</td><td>00</td><td>：</td><td></td><td></td><td></td><td></td><td>BNB,Polygon</td></tr><tr><td>Flamincome</td><td>[24]</td><td>：</td><td></td><td>：</td><td></td><td>：</td><td></td><td></td><td>Ethereum</td></tr><tr><td>Rari Capital</td><td>[39]</td><td>：</td><td>：</td><td>：</td><td>0</td><td></td><td></td><td></td><td>Ethereum</td></tr><tr><td>Vesper</td><td>[47]</td><td>：</td><td>0</td><td>：</td><td>0</td><td></td><td></td><td></td><td>Ethereum, Avalanche, Polygon</td></tr><tr><td>Spool Protocol</td><td>[45]</td><td>：</td><td></td><td>：</td><td>。</td><td></td><td></td><td></td><td>Ethereum</td></tr><tr><td>Harvest Finance</td><td>[30]</td><td>：</td><td></td><td>：</td><td></td><td></td><td></td><td></td><td>Ethereum,Polygon, BNB</td></tr><tr><td>ACryptoS</td><td>[4]</td><td>：</td><td></td><td>：</td><td>：</td><td></td><td></td><td></td><td>BNB,Fantom</td></tr><tr><td>Reaper Farm</td><td>[40]</td><td>：</td><td>：</td><td>：</td><td>：</td><td></td><td></td><td></td><td>Fantom</td></tr><tr><td>Pickle Finance</td><td>[38]</td><td>：</td><td>0</td><td>：</td><td>：</td><td></td><td></td><td></td><td>Ethereum,Polygon</td></tr><tr><td>OnX Finance</td><td>[34]</td><td>：</td><td></td><td>：</td><td></td><td></td><td></td><td></td><td>Ethereum,Polygon,Fantom,Avalanche</td></tr><tr><td>Waterfall DeFi</td><td>[48]</td><td>：</td><td></td><td>：</td><td></td><td></td><td></td><td></td><td>Avalanche,BNB</td></tr><tr><td>Solidex</td><td>[44]</td><td>：</td><td></td><td>：</td><td></td><td></td><td></td><td></td><td>Fantom</td></tr><tr><td>Robo-Vault</td><td>[42]</td><td>：</td><td>00</td><td>：</td><td>：</td><td></td><td></td><td></td><td>Fantom, Avalanche,Polygon</td></tr><tr><td>Magik Farm</td><td>[32]</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>BNB,Avalanche,Fantom</td></tr></table></body></html>

Data fetched on 28/08/2022 from corresponding documents.  

a) Stablecoins: In the recent low-interest environment in the traditional finance (TradFi) space, yield farming solutions that boast to offer a high single-digit to a double-digit annual percentage yield (APY) for USD-pegged stalecoins have been of particular interest. Most yield farming protocols offer stablecoin farming; in fact, among the top 20 yield aggregators, only Badger DAO has no stablecoin pool thus far.  

b) LP tokens: Many yield farming pools also accept LP tokens. As discussed in $\ S \mathrm { I I - C 1 }$ , LP tokens themselves already entitle their tokenholders to swap fee income. Nevertheless, having LP tokens managed by a yield farming pool provides the additional benefit of automatically converting and reinvesting participation reward (see ${ \displaystyle \ S I I I { - } D 3 }$ ) distributed by the respective AMMs.  

c) Others: Other asset types may also be eligible for yield farming. For example, Yearn Finance accepts ETH, the native currency on the Ethereum blockchain, as well as UNI and YFI, which are protocol governance tokens of Uniswap and Yearn Finance itself, respectively.  

# D. Sources of yield  

1) Supply interest: The most straightforward type of yield originates from lending. As the demand for loans in crypto assets grows, the borrowing interest rate increases, leading to higher yields for lenders. Particularly in a bullish market, speculators are keen to borrow funds despite a high interest rate, in expectation of an appreciation in the assets of their leveraged long position. A borrower wishing to increase their exposure to ETH, for example, may use ETH as collateral to borrow USDC, then repetitively exchanging USDC for ETH to deposit it as collateral to borrow more USDC, forming a “leveraging spiral” [131]. Compound [67] and Aave [55], two major DeFi lending protocols while writing this paper (see $ \ S \Pi \lnot C 2 \rrangle$ ), have witnessed the borrow APY of USDC rising from $2 - 3 \%$ in May 2020 to as high as $10 \%$ in April 2021.1 This specific kind of yield is incorporated in interest-bearing tokens, such as cTokens from Compound or aTokens from Aave.  

2) Swap fee income: Some tokens entitle users to part of the revenue that is going through the protocol. These can be governance tokens or other kinds of tokens. One example is the liquidity provider tokens in AMM-based DEXs [130]. By supplying liquidity into an AMM pool, users receive the fees that are paid by traders within that pool. The higher the volume in that pool, the more fees that are generated, and the more a liquidity provider profits from this. In Uniswap [122], a $0 . 3 \%$ fee is charged for every trade within a pool and goes fully to LPs.  

3) Participation reward: Another yield source comes from liquidity mining programs, where early participants receive native tokens representing protocol ownership. This incentivizes people to contribute funds into the protocol, and enhances decentralization as the protocol ownership is distributed to users. The native tokens often have a governance functionality attached to them which is deemed valuable, as the token holders have a say in the future strategic direction of the project. Native tokens sometimes also entitle holders to a share of the protocol revenue. Further, the values these tokens possess itself especially in a speculation context can be the benefits of owing a protocol.  

This brings up a second kind of revenue-sharing token, where users have to actively stake their tokens to receive a share of the revenue. For example, SUSHI holders that stake their SUSHI will get $\mathbf { \boldsymbol { x } } \mathbf { \boldsymbol { S } } \mathbf { \boldsymbol { U } } \mathbf { \boldsymbol { S } } \mathbf { \boldsymbol { H } } \mathbf { \boldsymbol { I } }$ in return, which represents the proportional share of a pool that captures $0 . 0 5 \%$ of all trades on Sushiswap [117]. Vesper Finance’s governance token, VSP, can also be deposited in a pool, in return for $\tt V V S P$ , a token that represents the user’s proportional share of a pool that captures part of the revenue generated throughout the whole Vesper platform [124].  

# E. Revenue model of yield farming protocols  

Yield farming protocols often retain a fraction of yield earned as the protocol revenue [132]. In the spirit of Decentralized Autonomous Organization (DAO), the revenue may be redistributed to tokenholders of the protocol governance token [133]. In that sense, a stronger buy pressure of a particular governance token of a yield farming protocol usually mirrors a larger (anticipated) TVL of the protocol, as it can translate to higher protocol revenue.  

# IV. YIELD FARMING RISKS  

Compared with asset management in traditional finance (TradFi), yield farming may bring substantial profits in short order but also carry a range of risks.  

# A. Security risks  

We identify four major types of attacks associated with yield farming. Table III presents anecdotal events of these attacks and their potential solutions.  

1) Flash loan attack: Flash loan attacks [110] abuse the mechanism of flash loan protocols in which an attacker borrows a great deal of funds that do not require collateral. The attacker then manipulates the price of an asset in a very short period and quickly resell it to earn profits. Such a procedure can be repeated for multiple time by the attacker, thereby causing considerable losses to investors and yield aggregators.  

Major yield aggregators have witnessed multiple waves of flash loan attacks, losing millions of dollars each. For example, ApeRocket suffered two flash loan attacks that costed investors 1.26 million USD on July 2021 [18]; in October 2020, a farmer leveraged flash loans to reap 33.8 million USD from the USDT and USDC pools [28]; Pancake Bunny Finance lost around 690,000 BUNNY tokens due to removal of liquidity and price manipulation by flash loan attacks [35].  

To defend against flash loan attacks, developers must consolidate and improve flash loan protocols, making them difficult to be exploited by attackers. An effective approach is to setup floating interest rates, thereby increasing the cost of launching flash loan attacks [35]. Developers can also choose to enhance the audits [7] or forbid depositing and withdrawing funds within a single transaction [51].  

2) Rug pull: A rug pull refers to the abandonment of a project by the project administrator after collecting investor’s funds, leaving investors with valueless assets [130], [118]. One way of conducting this type of scam is to lure yield farming protocols into buying assets with no value and then swap this asset for ETH or another type of asset with value. For example, Arbix Finance, a typical rug pull, drained around $1 0 \mathrm { ~ m ~ }$ USD in users’ assets directly from the vaults without any advanced attack techniques in sight [8].  

To prevent from being rugged, investors should exercise caution and always confirm a project’s credibility before investing in it [129], [95]. Besides, continuously tracking the audit information of invested projects enables investors to quickly identify risks and take appropriate measures, thereby reducing losses [43].  

3) Reentrancy attack: Even though the composability factor of DeFi is what makes yield farming possible in the first place by allowing for complex, interconnected financial protocols, it does bring along the danger of smart contract risk as more and more money legos are plugged into a strategy. While two smart contracts may be secure in isolation, the combination of them may not. By composing multiple smart contracts together, the attack surface might be greater than the sum of its parts [127], [126].  

Reentrancy attack is one of the most destructive attacks that appear when multiple smart contracts operate with each other. More specifically, the reentrancy attack occurs when a smart contract makes an external call to another smart contract. Then the another contract makes recursive calls back to the original function, intentionally or unintentionally withdraw funds. When the original contract fails to update its state before sending funds, the attacker can exploit this vulnerability to continuously drain the contract’s funds.  

Major yield aggregators have witnessed a large amount of reentrancy attacks in the past several years. In April 2021, the ForceDAO DeFi aggregator was exploited by a group of attackers, who utilized reentrancy attacks to steal 367 thousands USD worth of tokens before the ForceDAO team took effective actions to prevent further attacks [19]; in September 2021, DAO Maker, a decentralized finance platform on Ethereum, was hacked for almost 4 million USD due to insecure smart contracts [16]; a reentrancy attack on the Grim Finance project within the Fantom Blockchain also successfully drained over 30 million USD worth of tokens in 2021 [5].  

To defend protocols against reentrancy attacks, researchers and developers have proposed a variety of frameworks and methods [86]. For example, Rodler et al. [112] propose a backward compatible approach based on run-time monitoring and validation to protect smart contracts on Ethereum; Das et al. [73] propose a reentrancy-aware language called Nomos, which enforces reentrancy security using resourceaware session types; Cecchetti et al. [66] first formalize the reentrancy interface on general distributed systems and then leverage information flow control to automatically fix defective smart contracts. However, with the increasing complexity and variety of DeFi protocols, reentrancy attacks will also become increasingly difficult to detect and counter. From users’ side, protection can be sought from DeFi-native insurance protocols such as Nexus Mutual that cover smart contract risks [68].  

4) Key exploit: Due to poor access control of some DeFi systems, yield aggregators can be attacked by exploiting various keys (e.g., API key, wallet key) to tamper with the smart contracts or drain funds. For example, the Bent Finance utilized non-multisig wallets to deploy their project’s smart contracts. Anyone who knows the appropriate private key can perform updates to the contracts, allowing attackers to inject malicious code and create the backdoor. In December 2021, an attacker leveraged this feature to drain 1.75 million USD worth of tokens from the pool [13], [14], [20].  

To avoid attacks based on key exploiting, DeFi contracts should always be deployed upon multisig wallets to eliminate single points of failure [20]. DeFi platforms should also properly protect the private keys used to access and control correlative smart contracts. The developments of DeFi system API, application, and user interface should follow software security practices, ensuring that the access control and function calls are solidly implemented.  

5) Other attacks: As yield farming protocols are built upon multiple complex systems with a variety of software and hardware components interacting with each other, both technical and economic weaknesses give rise to attractive exploit opportunities for malicious hackers. Besides the aforementioned attacks, there are many other attacks targeting the blockchain infrastructure, user interface, or even network communications, thereby disturbing the proper operation of yield farming protocols. For example, malicious miners can prioritize transactions in their favor by inspecting maximal extractable values (MEVs), thereby causing damages to the smart contracts running on the upper layers [109], [135]; attackers can break the network connections between the users and the blockchain system through border gateway protocol (BGP) hijacking [58]; malicious traders can leverage frontrunning attacks to drain funds from pools [76].  

Table III: Overview of attacks in aggregators and potential solutions.   


<html><body><table><tr><td>Attacks</td><td>Yield aggregator attacked</td><td>Summary</td><td>Solutions</td><td>Estimated lost</td><td>References</td><td>Time</td><td>Major chain</td></tr><tr><td rowspan="2">Flash loan attack</td><td>ApeRocket</td><td>Using the fact that the AutoCake vault was onlydeployed 10 hours and waslowin TVL,atacker conducted price manipulation</td><td>Project team updated the protocol and at least two auditswill be conducted before its V2 launch.</td><td>1.26 m USD</td><td>[18], [6], [7]</td><td>07/14/2021</td><td>BNB</td></tr><tr><td>Pancake Bunny</td><td>and drained the vault. Within the timeframe to create a new block, attacker transferred USDT into the contract and called removal of liquidity. Caused the value of</td><td>A implementation of the Floating Rate of Emis- sions and the security code changes.</td><td>3 m USD</td><td>[35], [36], [25], [27], [23]</td><td>05/20/2021</td><td>BNB</td></tr><tr><td></td><td>Harvest Finance</td><td>Bunny token to crash by more than 95%. Attacker swappedUSDC to USDTto up the price of USDT,depositing USDT into vault and swap back USDT to USDC to gain profit as USDT price fall. This action is repeated to</td><td>Team updated the following: deposit and with- draw funds within a single transaction is not allowed to avoid flash loan, and withdraw of tokens are made into multiple transactions to</td><td>33.8 m USD</td><td>[28], [29], [51]</td><td>26/10/2020</td><td>Ethereum</td></tr><tr><td>Rug pull</td><td>Arbix Finance</td><td>The project team drained the vault with users assets,deleted their website,twiter and tele- gram.</td><td>Certik sent out a community alert.</td><td>10 m USD</td><td>[8], [43]</td><td>01/04/2022</td><td>BNB</td></tr><tr><td rowspan="4">Reentrancy attack</td><td>ForceDAO</td><td>The xFORCE platform used a fork of xSUSHI contractwhichrevert thetokenif transaction fails,they also used Aragon Minime token that</td><td>Team could have used a standard Open Zep- pelinERC-20oraddedasafe transferFrom wrapper in xSUSHI contract.</td><td>367 k USD</td><td>[21], [17]</td><td>04/03/2021</td><td>BNB</td></tr><tr><td>Grim finance</td><td>return false if a transferFrom() call fails. Attacker exploited a depositFor() function that had not been protected. Users deposited funds in to vaults thatattackerinsertedtheirowncon-</td><td>The team updated the code and send in for an audit.</td><td>30 m USD</td><td>[5], [2], [26], [22]</td><td>19/12/2021</td><td>Fantom</td></tr><tr><td>DAO Maker</td><td>tract containing the reentrancy deposit loops. The init(） function was vulnerable,attacker initialized 4 token contracts with malicious data then used the emergencyExit() function to drain funds.</td><td>The source code isnot public so protecting and checking the projectisapriority.Alsotofix the vulnerability in the function.</td><td>4 m USD</td><td>[16], [15]</td><td>09/03/2021</td><td>Ethereum</td></tr><tr><td>Reaper Farm</td><td>Attacker took advantage of that the recipients account verification had not been set up prop- erly and drained the vault.</td><td>The project team closed down the vaults at- tacked, altered the code and waiting for full audit before launching again.</td><td>1.7 m USD</td><td>[41],[33], [3]</td><td>01/08/2022</td><td>Fantom</td></tr><tr><td>Key exploit</td><td>Bent Finance</td><td>The contract used a non multisig wallet, al- lowing anyone that knows the private key to modify updates,which caused the attacker to create a back door. Attacker altered the code so that Bent finance would provide large amount</td><td>Project team could have used multisig wallet to avoid and protected private keys in an ap- propriate way.</td><td>1.75 m USD</td><td>[13], [14], [20]</td><td>12/21/2021</td><td>BNB</td></tr><tr><td></td><td>Badger DAO</td><td>of funds to the attacker's address. Attacker used acompromised API key to peri- odically inject malicious code into the contract. These codesare triggered when users try to perform transactions, allowing unlimited spend approvals for the attacker's adress.</td><td>Projectteam working with cybersecurity firm to fix the problem,as_well as authorities to recover any funds possible.</td><td>120 m USD</td><td>[11], [46], [19]</td><td>02/12/2021</td><td>BNB</td></tr></table></body></html>  

These attacks are out of scope for this paper, but it is important for users and developers to be aware of that yield farming security is a systemic problem. Only by ensuring the security of every component in the system can the security of yield seekers’ funds be ensured.  

# B. Economic risks  

Besides security concerns, there exist various economic risks associated with yield farming. In $\ S \mathbf { A } 2$ , we demonstrate that investment strategies with the potential to generate remarkably high yield also bear high risks. While our simulation only illustrate return courses in a deterministic fashion, through various simulated scenarios one can easily extrapolate that the ever-changing market conditions—including volatile price movements and trading activities—lead to return instability, and sometimes even losses. Below, we discuss several types of economic risks associated with yield farming.  

1) Yield dilution risk: Yield farming pools providing double or even triple digit APY can be deceiving in their return generating capability. Often enough, those pools are thin in liquidity and lack scalability, unable to accommodate a large amount of deposit while sustaining a similar level of APY. Users who invest a significant amount of funds into such a pool may find the pool APY dropping significantly immediately afterwards. For users with funds already in the pool, they may experience a decrease in return on their investment due to dilution from newly added funds. For those who do not constantly monitor their investment performance, this may mean leaving their funds in a diluted, low-APY pool, while missing the opportunity of reallocating their funds to more profitable strategies.  

2) Conversion risk: As discussed in $\ S _ { \mathrm { I I I - C } }$ , yield farming pools typically specify tokens that they can accept. Therefore, to participate in yield farming, users may have to first convert partially or all of their funds into acceptable assets for yield farming. This engenders conversion risk: a user might have been better off holding their original funds, than converting them to “eligible” assets. This is because the “eligible” assets might depreciate against the original assets prior to the conversion to such an extent that even the yield generated cannot make up for the depreciation loss. This risk is most prominent with liquidity provision strategies, manifested by the so-called “impermanent loss” (see [130]). By design, the value LP tokens (e.g. USDT-ETH-LP token) from an AMM-based DEX falls against the original portfolio (e.g. a combination of USDT and ETH). Sometimes, even the swap fee income and the participation reward are insufficient to cover the conversion loss.  

3) Exchange risk: Related to conversion risk, exchange risk is associated with the uncertainty surrounding the exchange rate between the assets held by the yield farming pool and the denominating currency (usually USD). As demonstrated in $\ S \mathbf { A } 2$ , yield farming strategies benefit from—and, in cases such as leveraged borrow, solely rely on—the high value of participation reward. This makes yield farming highly speculative as token prices are unpredictable. An overly low price of yielded tokens such as reward tokens might result in a loss for end users.  

4) Counterparty risk: This risk is associated with farming strategies that incorporate lending, where loans might not be repaid. While the simple lending strategy (see $\ S \mathrm { A } 2 \mathrm { a } )$ is a relatively low-risk one, losses may still occur under extreme market conditions, e.g. when the price of the asset lent out relative to the collateral suddenly increases to such a significant extent that the loan becomes undercollateralized (see lending protocol MakerDAO’s Black Thursday Incident [91], [100]). In such cases, borrowers may choose not to repay their loans since their collateral is not worth the effort anymore, resulting in a default. Kao et al. [90] simulate a wide range of market volatility to stress-test lending protocols such as Compound, and find that only rarely can undercollateralization occur.  

5) Liquidation risk: Liquidation risk is associated with farming strategies such as leveraged borrow (see $\ S _ { \mathbf { A } 2 \mathbf { b } } )$ ) that incorporate taking a overcollateralized loan on a PLF. Due to price movements and interest accrual, a loan position may become insufficiently collateralized, triggering liquidation of the deposited assets backing the loan. At liquidation, the value of the collateral liquidated by design exceeds the loan payable reduced, resulting a loss on the side of the borrower. Thus, yield farming protocols that implement borrow but unable to handle liquidation risk properly may cause users to lose their funds.  

• our paper examines a series of aspects of yield farming, including related DeFi protocols, yield generation, yield farming strategies, financial risks, and security issues, while most of the related papers only cover some of these topics.  

We discuss related literature in more details from different perspectives in the following subsections.  

# A. Yield farming  

A few papers focus on studying and comparing yield farming strategies or yield aggregators [59]. For instance, Nathan Walton [125] provides a break down of yield generating mechanism, covering four different farming strategies and a few other related topics (e.g., benefits and risks); Kanis Saengchote [114] studies DeFi composability, which covers yield-chasing behaviors and some introductions about major yield aggregators; another case study about Compound [113] also comes with explanations about yield aggregators and yield farming incentives; Popescu et al. [108] discuss the transition from the traditional finance to DeFi and include some descriptions about yield farming.  

However, none of these works have comprehensively investigated yield farming from the perspective of literature survey, modeling, empirical analysis, and taxonomization like our paper.  

# B. DeFi platforms  

As a type of DeFi application, yield farming is built upon DeFi platforms. Combing the design of general DeFi platforms lays the groundwork for yield farming designs. Moin et al. [98] and Pernice et al. [102] systematically study the general designs of DeFi platforms by decomposing the structure into diverse elements (i.e., peg assets, collateral amount, price and governance mechanism). They also investigate the merits and demerits of DeFi platforms to spot future directions. Nonetheless, yield farming is not the main focus of these works.  

# V. RELATED WORK  

In this section, we introduce literature that is related to yield farming in some shape and form. As it is still a fairly new area, there is a paucity of existing works related to our paper. Table IV summarizes the most related and representative ones.  

In general, our paper is different from existing papers in the following aspects:  

• our paper focuses on the subject of yield farming, while other papers either investigate a more specific DeFi topic (e.g., yield generating mechanism [125], yield chasing [114]), examine a different but related DeFi applications (e.g., AMM-based DEXs [130], lending [63]), or have a broader coverage (e.g., DeFi transformation [108]); • to investigate yield farming comprehensively, our paper utilizes multiple methodologies, including literature survey, modeling, empirical analysis, and taxonomization. In contrast, other papers use only one or a few of these methodologies to study their subjects;  

# C. Related DeFi protocols  

There are various papers studying the DeFi protocols (e.g., flash loan, lending, trading) that can be leveraged by yield farming. For example, as fundamental protocols of yield farming, the mechanisms, properties, and risks of DeFi lending protocols are extensively investigated in several publications [63], [100], [119], [90]; some papers [81], [100] provide analysis and discussions about protocols for Loanable Funds, introducing the interest rate determination and liquidity issues; Han et al. [82] zoom into the launch event of the yield farming protocols for Uniswap liquidity provision and further establish the causal impact of this on Binance investor trading activities; within the scope of the analysis of financial attack vectors that involve a flash loan, Qin et al. [110] study the existing flash loan-based attacks and propose optimizations that significantly improve the ROI of these attacks; Gudgeon et al. [80] explore how design weaknesses in DeFi protocols can trigger a decentralized financial crisis.  

Table IV: Overview of related literature.   


<html><body><table><tr><td></td><td></td><td colspan="3">Subjects Covered</td><td colspan="4">Methodology</td></tr><tr><td>Ref.</td><td>Summary</td><td>Yield farming strategies aggregators</td><td>Major yield</td><td>Risk evaluation</td><td>review</td><td>Literature Modeling Empirical Taxonomization analytics</td><td></td><td></td></tr><tr><td></td><td>This paper A survey that uses examples of yield strategies to compare the major yield aggregators, translating them into revenue models and empirical examinations supported with on-chain</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>[59]</td><td>data. A paper that characterizes the risk and return characteristics of yield farming investment strategies on PancakeSwap,one of the largest automated market makers among the</td><td>.</td><td></td><td>.</td><td>0</td><td>.</td><td>.</td><td></td></tr><tr><td>[114]</td><td>emerging ecosystem of decentralized financial services. A presentation of yield-chasing behavior adopting on-chain transaction level data and empirical analysis to support the result.The paper also classfies DeFi protocols including</td><td>.</td><td></td><td>O</td><td></td><td>O</td><td></td><td>.</td></tr><tr><td>[125]</td><td>major yield aggregators. A break-down of the mechanism of yield generating,also it provides an overview of four different strategies and other related DeFi services.</td><td></td><td></td><td></td><td></td><td>O</td><td></td><td>.</td></tr><tr><td>[91]</td><td>A case study assessing the stability of MakerDAO protocol,which uses public data and protocol analysis.</td><td></td><td></td><td>.</td><td></td><td></td><td></td><td></td></tr><tr><td>[113]</td><td>A case study about Compound with detailed explanation of how it works,and where it is applied.</td><td></td><td></td><td>.</td><td></td><td>O</td><td></td><td>0</td></tr><tr><td>[82]</td><td>An analysis of impact on trading using data from Binance'sand Uniswap's program in yield farming.It also compares their differences and evaluate how DeFi provides an</td><td>.</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>[108]</td><td>alternative solution to the traditional finance. A discussion of the transition from the traditional finance to DeFi and its advantages, covering methods of yield farming.</td><td>.</td><td></td><td>.</td><td></td><td></td><td></td><td>.</td></tr><tr><td>[131]</td><td>A presentation of the advantageous DeFi characteristics that would resolve a list of fundamental issues in the traditional lending system.</td><td></td><td>.</td><td>.</td><td></td><td>O</td><td></td><td>.</td></tr><tr><td>[63]</td><td>A systematic analysis on lending pools and their behavior,focuses on two specific lending platforms.</td><td>.</td><td></td><td>.</td><td></td><td>.</td><td></td><td>0</td></tr><tr><td>[81]</td><td>A discussion of the Protocol for Loanable Funds,also reviews the methodology of interest rate determination and provides empirical examination corresponding to different degrees</td><td></td><td>O</td><td>.</td><td></td><td></td><td></td><td></td></tr><tr><td>[100]</td><td>of liquidation. An empirical analysisof liquidation on Protocol for Loanable Funds,focuses on Compound. The paper also provides calculation of liquidators effciency and discusses</td><td>.</td><td>O</td><td>.</td><td></td><td></td><td>.</td><td></td></tr><tr><td>[98]</td><td>the security issues and risks. A discussion on the structure of stablecoins that breaks down existing stablecoins into components to compare and evaluates their advantages and disadvantages.</td><td></td><td>O</td><td></td><td></td><td>O</td><td></td><td>0</td></tr><tr><td>[130]</td><td>An SoK on AMM based DEX protocols,compares the popular protocols mechanisms and discusses the securities and privacy concerns.</td><td></td><td>O</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>[96]</td><td>A discussion on the method of maximizing the discounted value of future returns and analyzes the geometric relationships between the expectation and the choice of portfolio.</td><td></td><td></td><td></td><td></td><td>.</td><td></td><td>0</td></tr></table></body></html>  

Although these papers can cover almost all the DeFi protocols used by yield farming, our paper presents this topic more systematically by putting together all the relevant protocols, components, and problems worth exploring.  

yield provider will win the race. Besides security enhancement, new industry developments should consider building one-stop-shop solutions, in pursuit of aggregating more than just yield and facilitating the on-boarding of new DeFi users.  

# VI. CONCLUSION  

In this survey paper, we examine yield farming protocols from multiple perspectives. We first highlight yield farming’s dependence on lower-level DeFi primitives in the context of the broader DeFi ecosystem and propose a general framework for yield farming protocols. We then explain code-level actions and associated yield farming operations. We decompose various aspects of yield farming protocols such as protocol form, pool structure, accepted token types, and enumerate their variations. Later, we stylize three frequently used strategies and simulate yield farming performance under a set of assumptions. We also compare four major yield aggregators by summarizing their strategies and revenue models. Finally, we discuss security and economic risks of yield farming protocols, together with related work.  

While yield farming has been exploding since 2020, an important question remains if current yields will be sustainable in the long term. Higher rewards also imply higher risks, and associated DeFi attacks prove that the safest and most robust  

# ACKNOWLEDGMENT  

We would like to extend our sincere thanks to Simon Cousaert and Toshiko Matsui for the base of this paper [69]. We also would like to thank Yitian Wang and Honglin Fu for their research assistance.  

This material is based upon work partially supported by Ripple under the University Blockchain Research Initiative (UBRI) [79]. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of Ripple.  

# ACRONYMS  

IOU “I owe you”   
AMM automated market maker   
APY annual percentage yield   
DAO Decentralized Autonomous Organization   
dApp decentralized application   
DeFi decentralized finance   
DEX decentralized exchange   
DLT distributed ledger technology   
EVM Ethereum Virtual Machine   
LP liquidity provider   
MEV maximal extractable value   
NFT non-fungible token   
PLF protocol for loanable funds   
PoS proof of stake   
PoW proof of work   
TradFi traditional finance   
TVL total value locked  

# REFERENCES  

[1] “1inch,” accessed: 2022-11-12. [Online]. Available: https://app.1inch. io/#/1/unified/swap/ETH/DAI   
[2] $ { \mathrm { ~ \textrm ~ { ~ ~ } ~ } }  { \mathrm { \Phi } } 3 0$ million stolen from Grim Finance, audit firm blames new hire for vulnerability,” accessed: 2022-08-15. [Online]. Available: https://www.zdnet.com/article/30-million-stolen-from-defi-protocol- $\mathbf { g }$ rim-finance-audit-firm-apologizes-for-missing-vulnerability/   
[3] “8/1/2022 Reaper Farm Exploit Recovery Plan,” accessed: 2022-08-15. [Online]. Available: https://docs.google.com/document/d/1wymADZrv isr8UNU9BHWh9bgEsO28D2-awhOHlxlQ3X8/edit   
[4] “ACryptoS docs,” accessed: 2022-08-15. [Online]. Available: https: //docs.acryptos.com/   
[5] “Analysis of the Grim Finance Hack,” accessed: 2022-08-15. [Online]. Available: https://slowmist.medium.com/analysis-of-the-grim-finance -hack-bc440108b069   
[6] “ApeRocket Finance Incident Analysis — Improper Reward Minting,” accessed: 2022-08-15. [Online]. Available: https://inspexco.medium. com/aperocket-finance-incident-analysis-improper-reward-minting-5 2153a8958fa   
[7] “ApeRocket Releases Official Statement Regarding 1.2 Million DeFi Hack,” accessed: 2022-08-15. [Online]. Available: https: //www.bsc.news/post/aperocket-releases-official-statement-regarding1-2-million-decentralized-finance-defi-hack   
[8] “ARBIX FINANCE - REKT,” accessed: 2022-08-15. [Online]. Available: https://rekt.news/arbix-rekt/   
[9] “Auto farm docs,” accessed: 2022-08-15. [Online]. Available: https://autofarm.gitbook.io/autofarm-network/   
[10] “Badger dao docs,” accessed: 2022-08-15. [Online]. Available: https://badger-finance.gitbook.io/badger-finance/   
[11] “BadgerDAO Reveals Details of How It Was Hacked for $\$ 1200$ ,” accessed: 2022-08-15. [Online]. Available: https://www.coindesk.com /business/2021/12/10/badgerdao-reveals-details-of-how-it-was-hacke d-for- $1 2 0 \mathrm { m } /$   
[12] “Beefy finance docs,” accessed: 2022-08-15. [Online]. Available: https://docs.beefy.finance/   
[13] “BENT FINANCE - REKT,” accessed: 2022-08-15. [Online]. Available: https://rekt.news/bent-finance/   
[14] “Bent Finance confirms pool exploit, advises investors to withdraw funds,” accessed: 2022-08-15. [Online]. Available: https://cointelegrap h.com/news/bent-finance-confirms-pool-exploit-advises-investors-to -withdraw-funds   
[15] “DAO MAKER - REKT,” accessed: 2022-08-15. [Online]. Available: https://rekt.news/daomaker-rekt/   
[16] “DAO Maker Hack,” accessed: 2022-08-15. [Online]. Available: https://www.coinfirm.com/blog/dao-maker-hack/   
[17] “DeFi aggregator raided by five hackers on launch day,” accessed: 2022-08-15. [Online]. Available: https://cointelegraph.com/news/defiaggregator-raided-by-five-hackers-on-launch-day   
[18] “DeFi Yield Farming Aggregator ApeRocket Suffers $\$ 1.260$ ’Flash Loan’ Attack,” accessed: 2022-09-01. [Online]. Available: https://uk.fin ance.yahoo.com/finance/news/defi-yield-farming-aggregator-aperock et-153230316.html?guccounter=1&guce referrer=aHR0cHM6Ly93d3 cuZ29vZ2xlLmNvbS8&guce referrer sig=AQAAADu5E7nD5fyENrd A94UutsadM6zSa9g9vpls75qherSwUpaqgCPM9uRMC7ay3-kqbOE DBkkfkMrEM-O4qBBtBPFdbdKu9w2kgVujSc44sNiQyUfvuoGHiAt DCNqyjG9Y9y 7PJwvGLh1snrEy2dvs0qCssx3ah4qaUYP- DyR-S   
[19] “EXPLAINED: THE BADGERDAO HACK (DECEMBER 2021),” accessed: 2022-09-01. [Online]. Available: https://halborn.com/explai ned-the-badgerdao-hack-december-2021/   
[20] “EXPLAINED: THE BENT FINANCE HACK (DECEMBER 2021),” accessed: 2022-09-01. [Online]. Available: https://halborn.com/explai ned-the-bent-finance-hack-december-2021/   
[21] “EXPLAINED: THE FORCEDAO HACK (APRIL 2021),” accessed: 2022-09-01. [Online]. Available: https://halborn.com/explained-the-fo rcedao-hack-april-2021/   
[22] “EXPLAINED: THE GRIM FINANCE HACK (DECEMBER 2021),” accessed: 2022-09-01. [Online]. Available: https://halborn.com/explai ned-the-grim-finance-hack-december-2021/   
[23] “EXPLAINED: THE PANCAKEBUNNY PROTOCOL HACK (MAY 2021),” accessed: 2022-09-01. [Online]. Available: https://halborn.co m/explained-the-pancakebunny-protocol-hack-may-2021/   
[24] “Flamincome docs,” accessed: 2022-09-01. [Online]. Available: https://docs.flamincome.finance/guide/terminal   
[25] “Flash Loan Attack Causes DeFi Token Bunny to Crash Over $9 5 \%$ ,” accessed: 2022-09-01. [Online]. Available: https://www.coindesk.com /markets/2021/05/20/flash-loan-attack-causes-defi-token-bunny-to-cra sh-over-95/   
[26] “GRIM FINANCE REKT,” accessed: 2022-09-01. [Online]. Available: https://rekt.news/grim-finance-rekt/   
[27] “Hack Track: Pancake Bunny Hack,” accessed: 2022-09-01. [Online]. Available: https://medium.com/merkle-science/hack-track-pancake-b unny-hack-aaa62fe49313   
[28] “HARVEST FINANCE - REKT,” accessed: 2022-09-01. [Online]. Available: https://rekt.news/harvest-finance-rekt/   
[29] “Harvest Finance: $\$ 240$ Attack Triggers $\$ 5700$ ’Bank Run’ in Latest DeFi Exploit,” accessed: 2022-09-01. [Online]. Available: https://www.coindesk.com/tech/2020/10/26/harvest-finance- $2 4 \mathrm { m }$ -attac k-triggers-570m-bank-run-in-latest-defi-exploit/   
[30] “Harvest finance docs,” accessed: 2022-09-01. [Online]. Available: https://harvest-finance.gitbook.io/harvest-finance/   
[31] “Idle finance doc,” accessed: 2022-09-01. [Online]. Available: https://docs.idle.finance/   
[32] “Magik farm docs,” accessed: 2022-09-01. [Online]. Available: https://avery-bigweapon.gitbook.io/magik.farm-docs/   
[33] “Multi-Strategy Vault Post-Mortem,” accessed: 2022-08-15. [Online]. Available: https://docs.google.com/document/d/1aCEbz40BBC3y1R qDksnD9d-5IOXXgbeKAvJWMH2GoI4/edit   
[34] “OnX finance docs,” accessed: 2022-09-01. [Online]. Available: https://onx-finance.gitbook.io/docs/   
[35] “PancakeBunny Releases Recovery Plan Post Flash Loan Attack,” accessed: 2022-09-01. [Online]. Available: https://cryptodaily.co.uk/ 2021/06/pancakebunny-recovery-plan?utm source=dlvr.it&utm med ium=twitter   
[36] “Pancakebunny Security Code Change,” accessed: 2022-09-01. [Online]. Available: https://smartliquidity.info/2021/05/22/pancakebu nny-security-code-change/#more-13374   
[37] “ParaSwap: Best prices in defi for traders & dapps,” accessed: 2022-11-12. [Online]. Available: https://www.paraswap.io/   
[38] “Pickle finance docs,” accessed: 2022-09-01. [Online]. Available: https://docs.pickle.finance/   
[39] “Rari capital docs,” accessed: 2022-09-01. [Online]. Available: https://docs.rari.capital/   
[40] “Reaper farm docs,” accessed: 2022-09-01. [Online]. Available: https://docs.reaper.farm/reaper-farms/faq-1/why-use-reaper.farm   
[41] “Reaper Farm Just Lost US\$1.7 Million From Exploit Will It Be Able To Recover From This?” accessed: 2022-09-01. [Online]. Available: https://chaindebrief.com/reaper-farm-got-hacked/   
[42] “Robo vault docs,” accessed: 2022-09-01. [Online]. Available: https://docs.robo-vault.com/robovault/vaults   
[43] “Rug pull alert: Arbix Finance (ARBX) is a scam,” accessed: 2022-09-01. [Online]. Available: https://www.cryptopolitan.com/arbi $\mathbf { x } \cdot \mathbf { \partial }$ -finance-is-a-rug-pull/   
[44] “Solidex finance docs,” accessed: 2022-09-01. [Online]. Available: https://docs.solidexfinance.com/   
[45] “Spool protocol docs,” accessed: 2022-09-01. [Online]. Available: https://docs.spool.fi/technical-reference/understanding-the-protocol   
[46] “The BadgerDAO Hack: What really happened and why it matters,” accessed: 2022-09-01. [Online]. Available: https://zengo.com/the-badg erdao-hack-what-really-happened-and-why-it-matters/   
[47] “Vesper finance docs,” accessed: 2022-09-01. [Online]. Available: https://docs.vesper.finance/   
[48] “Waterfall defi docs,” accessed: 2022-09-01. [Online]. Available: https://defi-waterfall.gitbook.io/waterfall-finance/   
[49] “Yearn finance docs,” accessed: 2022-09-01. [Online]. Available: https://docs.yearn.finance/   
[50] “Yield yak docs,” accessed: 2022-09-01. [Online]. Available: https: //docs.yieldyak.com/   
[51] “‘Engineering Error’ Led to 34 million USD DeFi Hack, Harvest Finance Says,” accessed: 2022-09-01. [Online]. Available: https://decr ypt.co/46445/engineering-error-34-million-defi-hack-harvest-finance   
[52] “Axie Infinity,” 2022, accessed: 2022-11-10. [Online]. Available: https://axieinfinity.com/   
[53] “MOBOX,” 2022, accessed: 2022-11-10. [Online]. Available: https: //www.mobox.io/   
[54] “Pulsar Farm,” 2022, accessed: 2022-11-10. [Online]. Available: https://www.pulsar.farm/   
[55] Aave, “Open Source DeFi Protocol,” 2021, accessed: 2022-09-01. [Online]. Available: https://aave.com/   
[56] G. Angeris, H.-T. Kao, R. Chiang, C. Noyes, and T. Chitra, “An Analysis of Uniswap markets,” Cryptoeconomic Systems, 11 2020. [Online]. Available: https://cryptoeconomicsystems.pubpub.org/pub/a ngeris-uniswap-analysis   
[57] Ankr, “Ankr doc,” 2022, accessed: 2022-08-15. [Online]. Available: https://www.ankr.com/ankr-whitepaper-2.0.pdf   
[58] M. Apostolaki, A. Zohar, and L. Vanbever, “Hijacking bitcoin: Routing attacks on cryptocurrencies,” in 2017 IEEE symposium on security and privacy $( S P )$ . IEEE, 2017, pp. 375–392.   
[59] P. Augustin, R. Chen-Zhang, and D. Shin, “Yield farming,” Available at SSRN 4063228, 2022.   
[60] Avalanche, “Avalanche doc,” 2020.   
[61] Balancer, “Balancer,” 2021, accessed: 2022-08-15. [Online]. Available: https://balancer.finance/   
[62] Bank of Chain, “Bank of Chain Docs,” 2022, accessed: 2022-09-01. [Online]. Available: https://docs.bankofchain.io/en/   
[63] M. Bartoletti, J. H.-y. Chiang, and A. L. Lafuente, “SoK: Lending Pools in Decentralized Finance,” in Workshop Proceedings of Financial Cryptography and Data Security, vol. 12676 LNCS, 12 2021, pp. 553–578. [Online]. Available: https://link.springer.com/10.1007/978- 3-662-63958-0 40   
[64] J. Bertin, “What is NFT yield farming, and how does it work?” 6 2022, accessed: 2022-11-10. [Online]. Available: https://www.finance brokerage.com/what-is-nft-yield-farming-and-how-does-it-work/   
[65] BNBchain, “BNB doc,” 2022, accessed: 2022-08-15. [Online]. Available: https://docs.bnbchain.org/docs/bnbIntro/   
[66] E. Cecchetti, S. Yao, H. Ni, and A. C. Myers, “Compositional Security for Reentrant Applications,” in IEEE Symposium on Security and Privacy, 5 2021, pp. 1249–1267.   
[67] Compound, “Compound,” 2021, accessed: 2022-08-15. [Online]. Available: https://compound.finance/   
[68] S. Cousaert, N. Vadgama, and J. Xu, “Token-Based Insurance Solutions on Blockchain,” in Blockchains and the Token Economy: Theory and Practice, sep 2022, pp. 237–260. [Online]. Available: https://link.springer.com/10.1007/978-3-030-95108-5 9   
[69] S. Cousaert, J. Xu, and T. Matsui, “SoK: Yield Aggregators in DeFi,” in International Conference on Blockchain and Cryptocurrency. IEEE, may 2022, pp. 1–14. [Online]. Available: https://ieeexplore.iee e.org/document/9805523/   
[70] A. Cronje, “YFI. Under yearn.finance we have released,” 7 2020, accessed: 2022-09-01. [Online]. Available: https://medium.com/iearn /yfi-df84573db81   
[71] Curve Finance, “Curve Finance,” 2021, accessed: 2022-08-15. [Online]. Available: https://curve.fi/   
[72] “Understanding Tokenomics,” 2021, accessed: 2022-09-01. [Online]. Available: https://resources.curve.fi/base-features/understand ing-tokenomics   
[73] A. Das, S. Balzer, J. Hoffmann, F. Pfenning, and I. Santurkar, “Resource-aware session types for digital contracts,” in 2021 IEEE 34th Computer Security Foundations Symposium (CSF), 2021, pp. 1– 16.   
[74] DeFi Llama, “DeFi Leader Board,” accessed: 2022-08-15. [Online]. Available: https://defillama.com/chains   
[75] DeFi Score, “DeFi Score,” 2021, accessed: 2022-09-01. [Online]. Available: https://defiscore.io/   
[76] S. Eskandari, S. Moosavi, and J. Clark, “Sok: Transparent dishonesty: front-running attacks on blockchain,” in International Conference on Financial Cryptography and Data Security. Springer, 2019, pp. 170– 189.   
[77] Ethereum, “Ethereum2 doc,” 2022, accessed: 2022-09-01. [Online]. Available: https://ethereum.org/en/upgrades/   
[78] Fantom, “Fantom doc,” 2018, accessed: 2022-09-01. [Online]. Available: https://fantom.foundation/research/wp fantom v1.6.pdf   
[79] Y. Feng, J. Xu, and L. Weymouth, “University blockchain research initiative (ubri): Boosting blockchain education and research,” IEEE Potentials, vol. 41, no. 6, pp. 19–25, 2022.   
[80] L. Gudgeon, D. Perez, D. Harz, B. Livshits, and A. Gervais, “The Decentralized Financial Crisis,” in Crypto Valley Conference on Blockchain Technology (CVCBT), no. February. IEEE, 6 2020, pp. 1– 15. [Online]. Available: https://ieeexplore.ieee.org/document/9150192/   
[81] L. Gudgeon, S. Werner, D. Perez, and W. J. Knottenbelt, “DeFi Protocols for Loanable Funds,” in Proceedings of the 2nd ACM Conference on Advances in Financial Technologies. New York, NY, USA: ACM, 10 2020, pp. 92–112. [Online]. Available: https://dl.acm.org/doi/10.1145/3419614.3423254   
[82] J. Han, S. Huang, and Z. Zhong, “Trust in DeFi: An Empirical Study of the Decentralized Exchange,” 2021.   
[83] Harvest Finance, “FARM Token Info,” 2021, accessed: 2022-09-01. [Online]. Available: https://farm.chainwiki.dev/en/supply   
[84] “Harvest Finance Yield Farming Strategies,” 2021, accessed: 2022-09-01. [Online]. Available: https://farm.chainwiki.dev/en/strategy   
[85] “Harvest Vault ,” 2021, accessed: 2022-09-01. [Online]. Available: https://farm.chainwiki.dev/en/education/vault   
[86] Y. Huang, Y. Bian, R. Li, J. L. Zhao, and P. Shi, “Smart contract security: A software lifecycle perspective,” IEEE Access, vol. 7, pp. 150 184–150 202, 2019.   
[87] Idle Finance, “Distribution Idle,” 2021, accessed: 2022-09-01. [Online]. Available: https://developers.idle.finance/advanced/governan ce/distribution   
[88] “Idle Finance Documentation,” 2021, accessed: 2022-09-01. [Online]. Available: https://developers.idle.finance/   
[89] Jakub, “Yearn Finance And YFI Token Explained,” 2020, accessed: 2022-09-01. [Online]. Available: https://finematics.com/yearn-finance -and-yfi-explained/   
[90] H. T. Kao, T. Chitra, R. Chiang, and J. Morrow, “An Analysis of the Market Risk to Participants in the Compound Protocol,” in Third International Symposium on Foundations and Applications of Blockchain (FAB ‘20), 2020. [Online]. Available: https://scfab.github.i o/2020/FAB2020 p5.pdf   
[91] M. Kjaer, M. di Angelo, and G. Salzer, “Empirical Evaluation of MakerDAO’s Resilience,” in 3rd Conference on Blockchain Research & Applications for Innovative Networks and Services (BRAINS). IEEE, 9 2021, pp. 193–200. [Online]. Available: https://ieeexplore.ieee.org/ document/9569811/   
[92] R. Leshner, “Expanding Compound Governance.” 5 2020, accessed: 2022-09-01. [Online]. Available: https://medium.com/compound-finan ce/expanding-compound-governance-ce13fcd4fe36   
[93] Lido, “Liquidity for staked assets,” 2021, accessed: 2022-09-01. [Online]. Available: https://lido.fi/   
[94] J. Lipstone, “Rari Capital Partners with Saffron Finance,” 12 2020, accessed: 2022-09-01. [Online]. Available: https://medium.com/rari-ca pital/rari-capital-partners-with-saffron-finance-b80c82878c07   
[95] S. Mackenzie, “Criminology towards the metaverse: Cryptocurrency scams, grey economy and the technosocial,” The British Journal of Criminology, 2022.   
[96] H. Markowitz, “Portfolio Selection,” The Journal of Finance, vol. 7, no. 1, pp. 77–91, 1952.   
[97] milkyklim, “Introduction to Yearn,” 2021, accessed: 2022-09-01. [Online]. Available: https://docs.yearn.finance/   
[98] A. Moin, E. G. Sirer, and K. Sekniqi, “A Classification Framework for Stablecoin Designs,” Lecture Notes in Computer Science (including subseries Lecture Notes in Artificial Intelligence and Lecture Notes in Bioinformatics), vol. 12059 LNCS, pp. 174–197, 9 2019. [Online]. Available: http://arxiv.org/abs/1910.10098   
[99] E. Napoletano and B. Curry, “What is DeFi? understanding decentralized finance,” 4 2022, accessed: 2022-11-10. [Online]. Available: https://www.forbes.com/advisor/investing/cryptocurrency/de fi-decentralized-finance/   
100] D. Perez, S. M. Werner, J. Xu, and B. Livshits, “Liquidations: DeFi on a Knife-Edge,” in Financial Cryptography and Data Security, vol. 12675 LNCS. Springer, 2021, pp. 457–476. [Online]. Available: https://link.springer.com/10.1007/978-3-662-64331-0 24   
[101] D. Perez, J. Xu, and B. Livshits, “Revisiting Transactional Statistics of High-scalability Blockchains,” in ACM Internet Measurement Conference, vol. 16, no. 20. New York, NY, USA: ACM, oct 2020, pp. 535–550. [Online]. Available: https://dl.acm.org/doi/10.1145/341 9394.3423628   
[102] I. G. Pernice, S. Henningsen, R. Proskalovich, M. Florian, H. Elendner, and B. Scheuermann, “Monetary Stabilization in Cryptocurrencies – Design Approaches and Open Questions,” in Crypto Valley Conference on Blockchain Technology (CVCBT). IEEE, 6 2019, pp. 47–59. [Online]. Available: https://ieeexplore.ieee.org/document/8787560/   
[103] Pickle Finance, “Emission Schedule - Pickle Finance Docs,” 2021, accessed: 2022-09-01. [Online]. Available: https://docs.pickle.finance /faqs/emissions   
[104] M. Platt, J. Sedlmeir, D. Platt, J. Xu, P. Tasca, N. Vadgama, and J. I. Ibanez, “The Energy Footprint of Blockchain Consensus Mechanisms Beyond Proof-of-Work,” in 21st International Conference on Software Quality, Reliability and Security Companion (QRS-C). IEEE, dec 2021, pp. 1135–1144. [Online]. Available: https://ieeexplore.ieee.org/ document/9741872/   
[105] Polkadot, “Polkadot doc,” 2016, accessed: 2022-09-01. [Online]. Available: https://polkadot.network/PolkaDotPaper.pdf   
[106] Polygon, “Polygon doc,” 2021, accessed: 2022-09-01. [Online]. Available: https://polygon.technology/lightpaper-polygon.pdf   
[107] PoolTogether, “Home Page,” 2021, accessed: 2022-09-01. [Online]. Available: https://pooltogether.com/   
[108] A.-d. Popescu, “Transitions and Concepts Within Decentralized Finance ( Defi ) Space,” Social Science Research, no. May, pp. 40–61, 2020. [Online]. Available: https://www.researchgate.net/publication/3 44348838 TRANSITIONS AND CONCEPTS WITHIN DECENTR ALIZED FINANCE DEFI SPACE   
[109] K. Qin, L. Zhou, and A. Gervais, “Quantifying blockchain extractable value: How dark is the forest?” in 2022 IEEE Symposium on Security and Privacy (SP). IEEE, 2022, pp. 198–214.   
[110] K. Qin, L. Zhou, B. Livshits, and A. Gervais, “Attacking the DeFi Ecosystem with Flash Loans for Fun and Profit,” in Financial Cryptography and Data Security, vol. 12674 LNCS. Springer, 2021, pp. 3–32. [Online]. Available: https://link.springer.com/10.1007/978- 3-662-64322-8 1   
[111] Rari Capital, “Rari Capital,” 2021, accessed: 2022-09-01. [Online]. Available: https://www.rari.capital/index.html   
[112] M. Rodler, W. Li, G. O. Karame, and L. Davi, “Sereum: Protecting Existing Smart Contracts Against Re-Entrancy Attacks,” in Network and Distributed System Security Symposium (NDSS), 2019.   
[113] K. Saengchote, “Decentralized lending and its users: Insights from Compound,” Tech. Rep., 2022. [Online]. Available: https: //ssrn.com/abstract=3925344   
[114] “Where do DeFi stablecoins go? A closer look at what DeFi composability really means.” 2022. [Online]. Available: https://papers.ssrn.com/sol3/papers.cfm?abstract id=3893487   
[115] F. Scha¨r, “Decentralized Finance: On Blockchain- and Smart ContractBased Financial Markets,” Federal Reserve Bank of St. Louis Review, pp. 153–74, 2021. [Online]. Available: https://research.stlouisfed.org/ publications/review/2021/02/05/decentralized-finance-on-blockchain-a nd-smart-contract-based-financial-markets?fbclid=IwAR2EJyX0LLTh FztaI0kuxOgG6aiXM25mbuiOTl04ZXgvAZjl1NqKxU fJoc   
[116] Solana, “Solana doc,” 2018, accessed: 2022-09-01. [Online]. Available: https://solana.com/solana-whitepaper.pdf   
[117] Sushiswap, “FAQ - xSUSHI,” 2021, accessed: 2022-09-01. [Online]. Available: https://docs.sushi.com/faq#xsushi-staking   
[118] The European Business Review, “What Is A “Rug Pull” In Crypto? DeFi Exploits Explained,” 1 2021. [Online]. Available: https://www.europeanbusinessreview.com/what-is-a-rug-pull-in-crypt o-defi-exploits-explained/   
[119] P. Tolmach, Y. Li, S.-W. Lin, and Y. Liu, “Formal Analysis of Composable DeFi Protocols,” 2 2021. [Online]. Available: http://arxiv.org/abs/2103.00540   
[120] P. Treleaven, A. Greenwood, H. Pithadia, and J. Xu, “Web 3.0 tokenization and decentralized finance (defi),” Available at SSRN 4037471, 2022.   
[121] Uniswap, “Introducing UNI,” 9 2020, accessed: 2022-09-01. [Online]. Available: https://uniswap.org/blog/uni/   
[122] “Uniswap,” 2021, accessed: 2022-09-01. [Online]. Available: https://uniswap.org/   
[123] Vesper Finance, “Homepage Vesper Finance,” 2021, accessed: 2022-09-01. [Online]. Available: https://vesper.finance/   
[124] “Vesper’s Tokenomics,” 2 2021, accessed: 2022-09-01. [Online]. Available: https://medium.com/vesperfinance/vespers-tokenomics-an -overview-f342ae5b613f   
[125] N. Walton, “Yield Generation Using Decentralized Financial (DeFi) Applications,” Ph.D. dissertation, 2022. [Online]. Available: https: //scholarcommons.sc.edu/cgi/viewcontent.cgi?articl $\mathbf { \sigma } = \mathbf { \sigma }$ 1546&context=s enior theses#: $\sim$ :text=Decentralizedfinancial(DeFi)applicationsare,mu chlikeatraditionalbank.   
[126] Z. Wan, X. Xia, D. Lo, J. Chen, X. Luo, and X. Yang, “Smart contract security: A practitioners’ perspective,” in 2021 IEEE/ACM 43rd International Conference on Software Engineering (ICSE), 2021, pp. 1410–1422.   
[127] Z. Wang, H. Jin, W. Dai, K.-K. R. Choo, and D. Zou, “Ethereum smart contract security research: survey and future research opportunities,” Frontiers of Computer Science, vol. 15, no. 2, pp. 1–18, 2021.   
[128] S. M. Werner, D. Perez, L. Gudgeon, A. Klages-Mundt, D. Harz, and W. J. Knottenbelt, “SoK: Decentralized Finance (DeFi),” 1 2021. [Online]. Available: http://arxiv.org/abs/2101.08778   
[129] P. Xia, H. Wang, B. Gao, W. Su, Z. Yu, X. Luo, C. Zhang, X. Xiao, and G. Xu, “Trade or trick? detecting and characterizing scam tokens on uniswap decentralized exchange,” Proceedings of the ACM on Measurement and Analysis of Computing Systems, vol. 5, no. 3, pp. 1–26, 2021.   
[130] J. Xu, K. Paruch, S. Cousaert, and Y. Feng, “SoK: Decentralized Exchanges (DEX) with Automated Market Maker (AMM) protocols,” ACM Computing Surveys, nov 2022. [Online]. Available: https: //dl.acm.org/doi/10.1145/3570639   
[131] J. Xu and N. Vadgama, “From Banks to DeFi: the Evolution of the Lending Market,” in Enabling the Internet of Value: How Blockchain Connects Global Businesses, 4 2022, ch. 6, pp. 53–66. [Online]. Available: https://link.springer.com/10.1007/978-3-030-78184-2 6   
[132] T. A. Xu and J. Xu, “A Short Survey on Business Models of Decentralized Finance (DeFi) Protocols,” in Workshop Proceedings of Financial Cryptography and Data Security, 2 2022.   
[133] T. A. Xu, J. Xu, and K. Lommers, “DeFi vs TradFi: Valuation Using Multiples and Discounted Cash Flow,” oct 2022. [Online]. Available: https://arxiv.org/abs/2210.16846   
[134] Yearn Finance, “yearn.finance,” 2021, accessed: 2022-09-01. [Online]. Available: https://yearn.finance/   
[135] L. Zhou, K. Qin, A. Cully, B. Livshits, and A. Gervais, “On the justin-time discovery of profit-generating transactions in defi protocols,” in 2021 IEEE Symposium on Security and Privacy (SP). IEEE, 2021, pp. 919–936.   
[136] ZooKeeper Finance, “ZooKeeper,” 2022, accessed: 2022-11-10. [Online]. Available: https://www.zookeeper.finance/  

![](images/ccac662000711e71faa80d6d6dad6e0c40596c7cc9f5a1251143e7f7a58863ea.jpg)  

Jiahua Xu is a Lecturer in Financial Computing, and Programme Director of the MSc Emerging Digital Technologies at the Computer Science Department of UCL. She is also affiliated to the UCL Centre for Blockchain Technologies, and a founding member of the UK FinTech Academic Network. Her research focuses on blockchain economics and decentralized finance. She has published in Usenix Security, ACM IMC, FC, IEEE ICDCS and IEEE ICBC. She has reviewed for Advances in Complex Systems, Computer Networks, Transactions on the Web and Cities.  

![](images/fee9ef469a4c3d48efd86e20b634a59b3c190f937dde19e9780f7b4023bde81e.jpg)  

Yebo Feng is a Ph.D. candidate in the Department of Computer and Information Science at the University of Oregon (UO), where he conducts his research in the Center for Cyber Security and Privacy. His research interests include network security, blockchain security, and network traffic analysis. He is the recipient of the Best Paper Award of 2019 IEEE CNS, Gurdeep Pall Graduate Student Fellowship of UO, and Ripple Research Fellowship. He has served as the reviewer of IEEE TDSC, IEEE TIFS, IEEE JSAC, and ACM TKDD.  

# APPENDIX  

# 2) Simulation results:  

# A. Simulating yield Farming Strategies  

A yield farming strategy is made of a specific set of actions (see ${ \ \ S } ^ { \mathrm { { I I I - B 2 } } } ,$ through modular smart contracts that automates the yield farming process. In this section, we describe three common yield farming strategies: simple lending, leveraged borrow, and liquidity provision. Besides, to intuitively and roughly compare the performance differences of these yield farming strategies, we simulate each strategy in a controlled, parameterized, simplified environment by tracking the trajectory of the total value $W$ of the yield aggregator2.  

1) Assumptions: On comparing the three common strategies, for simple demonstration purposes without loss of generality, we make the following assumptions:  

1. the transaction cost is neglected;   
2. the value of the yield farming pool $\mathbf { } W _ { t }$ is measured in USDT; at $t = 0$ , the pool contains 1 USDT’s worth of funds, i.e., $W _ { 0 } = 1$ ;   
3. the pool initially supplies all its funds to a yieldgenerating protocol—either a PLF or an AMM, and the funds represent $1 \%$ of the protocol’s total assets held at $t = 0$ ;   
4. the yield-generating protocol—either a PLF or an AMM—distributes 0.01 governance token per day to its users proportionately to their stake in the protocol: a. for a PLF, half of the governance tokens are distributed to lenders proportionate to their deposits, and half to borrowers proportionate to their loans, b. for an AMM, the governance tokens are distributed proportionately to LPs;   
5. the governance token price remains constant during the simulation period;   
6. the lending platform has an non-linear interest rate model [81] as illustrated in Figure 4;   
7. the AMM has a fixed exchange fee of $5 \%$ and applies a Uniswap-like constant-product conservation function;3 the fee is charged by retaining $5 \%$ of the theoretical feefree purchase quantity within the AMM pool.  

2The code repository can be found from this URL: https://github.com/xujiahuayz/yieldAggregators.  

a) Simple lending: The yield farming pool grows its wealth through accrual of supply interest and reward tokens distributed by the PLF.  

![](images/d537e41702cac7c4fd799067ef4d627f69662432e94c55d9845ef252d0593dc1.jpg)  
Figure 4: Interest rate model for the simulation.  

Simulated strategy execution. In our simulated environment, at $t = 0$ the yield aggregator deposits 1 USDT to a PLF, and receives in return some interest-USDT as a certificate of deposit (see $\{ \mathrm { I I - C } 2 )$ . According to Assumption 3., the aggregator owns $1 \%$ of the total circulating supply of interest-USDT.  

3We refer the reader to [56] for detailed description and analyses on AMMs with constant-product conservation function.  

The interest-USDT holding of the aggregator is worth exactly 1 USDT at $t = 0$ , and increases in value due to interest accrued with the passage of time. In addition, the farming pool is rewarded with the PLF’s governance tokens owing to its supply contribution, and the value of the governance token holding is counted towards the total value of the yield farming pool.  

Simulated scenarios. At each given rewarded protocol token price, we simulate three scenarios: the initial utilization ratio of the funds in the lending pool equals 0, 0.4, 0.8, respectively. As illustrated in Figure 4, a higher utilization ratio indicates a higher supply interest rate.  

Results. Figure 5a shows that, the value held by the aggregator $W _ { t }$ is floored at 1 USDT, with the worst-case scenario when the supply interest equals 0 due to the absence of borrow demand and the reward token has 0 value. Intuitively, $\mathbf { } W _ { t }$ increases with higher utilization and reward token price.  

b) Leveraged borrow: According to Assumption 4.a and in line with practices of major lending platforms such as Compound [67], governance tokens are rewarded to both lenders and borrowers. This strategy thus aims to maximize the amount of governance tokens received by the lending platform through leveraging spirals.  

Simulated strategy execution. In our simulated environment, at $t = 0$ the yield aggregator first deposits 1 USDT to a lending platform; with this initial deposit as collateral, the aggregator then takes a loan worth $6 5 \%$ of its deposit, i.e. 0.65 USDT. To further augment its deposit and borrow amount for the entitlement of larger rewards, the aggregator re-deposits the borrowed funds, and use them as collateral to borrow again $0 . 6 5 \%$ of the new deposit; and so on and so forth. Obviously, the more spirals the yield farming pool undertakes, the higher shares it holds at both the lending and the borrowing sides of the lending platform.  

Simulated scenarios. We assume the initial utilization ratio of the PLF’s lending pool is 0.4. At each given reward token price, we simulate three scenarios: (i) depositing without borrowing, (ii) lending and repeat borrowing and re-supplying 3 times, (iii) lending and repeat borrowing and re-supplying 6 times.  

Results. As an asset’s borrow interest rate always exceeds its supply interest rate, the loan accrues interest exponentially faster than its deposit. We observe from Figure 5b that sufficiently valuable reward tokens can make the strategy profitable, but losses occur when the value of the governance tokens received is insufficient to offset the negative net interest revenue. Overall, a high degree of leverage, measured by the number of spirals, can amplify both the profit—in case of high-value governance tokens, as well as the loss—in case of low-value governance tokens.  

![](images/e9005596bf87ff3a7460049f926d84d9754b5f60b4dd0c72e790043afbb1a380.jpg)  
Figure 5: Simulation results of various yield farming strategies.  

c) Liquidity provision: The yield farming pool supplies funds to an AMM in order to profit from both trading fees and governance tokens rewarded by the AMM.  

Simulated strategy execution. In our simulated environment, at $t = 0$ the aggregator deposits 1 USDT’s worth of funds in the USDT-ETH pool of an AMM, and receives in return some USDT-ETH-LP tokens, representing its share in the AMM pool. According to Assumption 3., the aggregator owns $1 \%$ of the total circulating supply of USDT-ETH-LP. Given that USDT is the denominating asset (Assumption 2.), and that the USDT-ETH pool applies a constant-product conservation function (Assumption 7.), the USDT-ETH pool always contains USDT and ETH with equivalent value, and the total pool value thus equals twice the USDT quantity in the pool.4  

We additionally assume that, on an aggregate level, further liquidity provision and withdrawal cancel each other out. Hence, the aggregator’s ownership of the AMM pool is neither diluted nor concentrated; that is, the value of the aggregator’s USDT-ETH-LP holding remains $1 \%$ of the USDT-ETH pool’s value. Naturally, all other things equal, the value held by the aggregator increases with the value of the AMM governance token.  

Simulated scenarios. We test scenarios with different market movements. Specifically, we illustrate in 5c when during the entire simulation period (i) there is 0 trading volume (blue line), (ii) the buy and sell volume of ETH is respectively 45 USDT and 55 USDT (orange line), (iii) the buy and sell volume of ETH is each 50 USDT (green line), (iv) the buy and sell volume of ETH is respectively 55 USDT and 45 USDT (orange line). We assume that the trading volume is evenly spread out throughout the simulation period.  

Absent any trading activity—as in Scenario (i), the aggregator’s yield solely comes from governance token reward. The yield difference between Scenarios (i) and (iii) lies in the trading fee. By comparing the blue line and the green line in Figure 5c, we clearly see that (iii) results in higher yield with the presence of $5 \%$ trading fee.  

Scenario (ii) describes a market situation with higher selling pressure and consequently falling ETH prices. The leads to an increase in the quantity of the depreciated ETH and a decrease in the quantity of the denominating asset USDT in the AMM pool, diminishing the AMM pool’s value. When the trading fee revenue and governance token reward are insufficient to offset this value loss, the yield would be negative.  

In contrast to Scenario (ii), Scenario (iv) describes an opposite market situation where a higher demand in ETH drives up its price. The leads to a decrease in the quantity of the appreciated ETH and an increase in the quantity of the denominating asset USDT in the AMM pool, raising the AMM pool’s value.  

Note that in both Scenarios (ii) and (iv), liquidity providers suffer from divergence loss [130], that is, they could have been better off by just holding their USDT and ETH, as opposed to supplying them to the AMM pool.  

Results. The simulation shows that the liquidity provision strategy also entails risk, associated with market movements of the assets within the AMM pool. Higher volatility of the AMM pool assets implies higher uncertainty in yield.  

# B. Current Major yield aggregators in DeFi  

As listed in Table I, to date, yield aggregators have collected billions of dollars worth of liquidity. This section compares current major yield aggregators with a focus on their strategies, performances, and fee mechanisms. Table II lists the characteristics of current top 20 yield aggregators. All the data was collected on 28 August 2022.  

1) Yearn Finance: Yearn Finance offers a multitude of products in DeFi, providing lending aggregation, yield generation and others [97]. The services discussed here are Yearn Earn, a lending aggregator, and Yearn Vaults, a more comprehensive yield aggregator. Yearn Finance launched in July 2020.  

a) Strategies:  

• Earn pools: The strategy of the Earn pools is to collect a certain asset and deposit it either in dYdX, Aave or Compound, depending on where the highest interest rate of that asset is found. Yearn will withdraw from one protocol and deposit to another automatically as interest rates change between protocols, in a strategy that is slightly similar to the Idle Finance “Best-Yield”  

Strategy. Proportional shares in Earn pools are commonly represented by yTokens.  

• Vaults: A Yearn Vault uses an asset as liquidity, deposits that liquidity as collateral (accounting for risk levels) to borrow stablecoins. Then, it uses those stablecoins to generate yield, after which that yield is re-invested in the stablecoins to generate more yield. Vaults thus allow for more complex strategies compared to Earn pools. Proportional shares in Yearn Vaults are commonly represented by yvTokens or other yTokens.  

Yield farming strategies in Yearn v2 Vaults can be complex, involving flash loans (uncollateralized loans that are taken and repaid within the same transaction [131]), leveraged borrowing, staking on specific protocols (for example HegicStaking) and more.  

b) Return for users: Yearn Finance distributed the YFI governance token over a 9-day period after launch. Liquidity providers in the Earn pools or Vaults are thus not incentivized by a Yearn liquidity mining program, so current yield only comes from the returns that the product strategies reap. Those returns can be straightforward, as is the case for Earn pools, and can be complex to calculate, as is the case for v2 Vaults that can have up to 20 strategies working at once. Some Yearn vaults accept LP tokens, other accept single asset tokens.  

c) Protocol fees: v1 Vaults have a $20 \%$ performance fee and a $0 . 5 \%$ withdrawal fee (in case funds need to be pulled from the strategy in order to cover the withdrawal request). v2 Vaults have also a $20 \%$ performance fee, but no withdrawal fee. Instead, they charge a $2 \%$ management fee. Performance fees are split 50:50 between the Treasury and the Strategist, the official creator of the strategy. The management fee is assigned fully to the Treasury.  

2) Idle Finance: Launched in August 2019, Idle is a yield aggregator that automatically allocates and aggregates interestbearing tokens [88].  

a) Strategies: Idle Finance only distributes single-asset pools over different lending protocols. Users’ funds are pooled together and depending on the strategy that the pool employs, assets are allocated over different lending platforms, currently limited to: Compound, Fulcrum, Aave, DyDx and Maker DSR. In Idle Finance, the currently supported pools can be deposited directly into the above lending platforms. When any user interacts with Idle or if no interactions are made for 1 hour, rebalancing of the assets takes place according to the rates of supported providers.  

Currently, Idle uses two different allocation strategies:  

• Best-Yield: this strategy seeks the best interest rates across multiple lending protocols. • Risk-Adjusted: this strategy automatically changes the asset pool allocation in order to find an allocation with the highest risk-return score, compared to the highest return score of the “Best Yield” strategy. It does this by incorporating a framework for quantifying risk, developed by DeFiScore [75], which outputs a 0-10 score that represents the level of risk on a specific lending platform $0 =$ highest risk, $1 0 =$ lowest risk). b) Return for users: Idle uses IdleTokens to represent the farmers’ proportional ownership of the asset pool, which should accrue yield over time. In addition, farmers are rewarded with IDLE governance tokens for participating in the pools as part of Idle’s liquidity mining program. In January 2021, a two-year liquidity mining program started to reward liquidity providers depending on the amount of funds deposited and the utility generated by a certain pool [87].  

c) Protocol fees: A performance fee $10 \%$ of the generated yield is charged.  

3) Harvest Finance: Harvest Finance gives FARM holders the opportunity to share in the revenue model of the protocol. By staking FARM, users are entitled to receive part of the revenue that is collected by the protocol. Harvest Finance went live in August 2020, and currently has more than 70 pools/vaults in its offering.  

a) Strategies: Harvest Finance has two main categories of yield farming strategies [84]:  

Simple single-asset Strategies: Users deposit single assets such as USDC, USDT, DAI, WBTC, renBTC or WETH into a Harvest Vault, which then deposits those assets into another yield generating protocol, including Compound and Idle Finance.   
• LP token Strategies: Users deposit LP tokens from Uniswap, Sushiswap or Curve into Harvest which automatically collects liquidity mining rewards and re-invests them into LP tokens.  

b) Return for users: Depending on the vault used, return of Harvest users is composed of (i) the fees accrued by providing liquidity to AMM pools or other yield-bearing assets, (ii) earning tokens distributed through external liquidity mining programs and (iii) extra FARM tokens as part of the liquidity mining program. These returns are dependent on underlying market forces, liquidity programs and token values. For example, the Harvest emission schedule defines how much FARM will be distributed over time [83].  

c) Protocol fees: Harvest Finance does not charge withdrawal fees and does not claim a direct “fee” on the yield farming revenue. However, during liquidation of the yield, $30 \%$ of the profits is used to buy the FARM token on the market, which is then distributed to users who stake FARM in the profit-sharing FARM pool [85].5  

4) Pickle Finance: Launched in September 2020, Pickle offers yield on deposits through two products: Pickle Jars (pJar) and Pickle Farms. Jars are yield farming robots, earning returns on users’ funds, while farms are liquidity mining pools where users can earn PICKLE governance tokens by staking different kinds of assets. Proportional shares in pJars are represented by pTokens.  

a) Strategies: Each Pickle Jar employs a specific strategy to earn yield. Currently, two main versions of pJar strategy are in existence, pJar 0.00 and pJar 0.99, of which the 0.99 version is most important. In either version, pooled funds are directly utilized to farm rewards, after which they are sold to re-invest the accrued yield.  

pJar 0.00: These pJars involve a user depositing LP tokens acquired by supplying liquidity on Curve Finance [71],  

5This type of buyback reduces the supply of governance tokens in the secondary market to the benefit of existing tokenholders.  

an AMM-based DEX. The strategy employed in pJar 0.00 earns and re-invests CRV rewards by selling CRV into the market for stablecoins and re-depositing those into the Curve pools to get more LP tokens. Effectively, pJars 0.00 generate yield by accruing (i) LP fees from Curve and (ii) generating CRV tokens because of Curve’s liquidity mining program [72].  

• pJar 0.99: These pJars utilize LP tokens from Uniswap and Sushiswap, earning yield by accruing (i) LP fees from Uniswap/ Sushiswap and (ii) generating SUSHI or other native tokens because of liquidity mining programs.  

b) Return for users: Return of Pickle users is generally composed of (i) the fees accrued by providing liquidity to AMM pools, (ii) earning tokens distributed through external liquidity mining programs, and (iii) extra PICKLE tokens if the yield farmer makes use of the Farm products. The return is thus dependent on underlying market forces, liquidity programs and token values. For example, the Pickle emission schedule defines how much PICKLE will be distributed over time [103].  

c) Protocol fees: Most Pickle Jars have a $20 \%$ performance fee on the generated yield.  

5) Other aggregators: The four main yield aggregators above are deemed the most mature, but a new wave of yield aggregating protocols is coming up. In general, there seems to be a tendency where more recent yield aggregators aim to be a one-stop-shop, providing additional functionalities such decentralized exchanges, lending and borrowing and risk-managing services. This enhances user experience and introduces more revenue streams for the protocols.  

Below we list more recently launched protocols and products that are still being tested.  

a) Rari Capital: Rari Capital [111] is a roboadvisor that attempts to provide investors with the highest yield, beyond just lending. It has multiple products, including Earn, Tranches, Fuse and Tanks. The Earn product can be considered a traditional yield farming service, while the other products are extending the number of functionalities on the Rari Capital platform, such as lending and borrowing, and yield farming within certain risk boundaries, called “tranches” [94].  

b) Vesper Finance: Vesper [123] focuses on institutional adoption of the DeFi yield market. Currently, only Vesper Grow Pools are available, which are comparable to the traditional yield products. In future developments, Vesper plans to integrate Vesper Labs [123] where external users can build their own strategy in return for part of the reaped profits.  

6) Summary: Many yield farming strategies entail some extent of optimization, e.g. choosing the lending pool that offers the highest APY to deposit assets into (e.g. Idle’s Best-Yield pools, Yearn’s earn pools), or balancing between risks and return (e.g. Idle’s risk-adjusted pools). The core strategies applied by major yield aggregators commonly do not deviate much from the basic strategies described in $\ S \mathrm { A }$ . However, as the competition in yield farming grows, basic strategies becomes less effective [89], which prompts protocols to device more sophisticated strategies that incorporate various forms of interactions with other DeFi protocols (e.g. upgrade from Yearn v1 to v2). Yield aggregators generate revenues by charging fees from investors. Protocols associated with better yield farming performance are able to charge higher fees, which can be observed by comparing both the performance fee between Yearn $( 2 0 \% )$ and Idle $( 1 0 \% )$ as well as their respective performance.  